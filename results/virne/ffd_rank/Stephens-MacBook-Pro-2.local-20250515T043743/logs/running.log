[32mINFO    [0m Use ffd_rank Solver (Type = node_ranking)...
[0m
[32mINFO    [0m Dataset Dir of Physical Network: virne/dataset/p_net/100-waxman_[0.5-0.2]-cpu_[50-100]-max_cpu_None-bw_[50-100]-max_bw_None[0m
[1;31mCRITICAL[0m Physical Network: Loaded from virne/dataset/p_net/100-waxman_[0.5-0.2]-cpu_[50-100]-max_cpu_None-bw_[50-100]-max_bw_None[0m
[32mINFO    [0m Config: {'experiment': {'if_load_pnet': True,
                'if_load_vnet': True,
                'if_save_config': True,
                'if_save_pnet': False,
                'if_save_vnet': False,
                'num_simulations': 1,
                'run_id': 'Stephens-MacBook-Pro-2.local-20250515T043743',
                'save_root_dir': 'virne/',
                'seed': 0},
 'inference': {'decode_strategy': 'greedy', 'k_searching': 1},
 'logger': {'backends': ['console', 'file', 'tensorboard'],
            'experiment_name': 'default_experiment',
            'level': 'INFO',
            'log_dir_name': 'logs',
            'log_file_name': 'running.log',
            'log_show_interval': 20,
            'project_name': 'virne',
            'verbose': 1},
 'nn': {'batch_norm': False,
        'dropout_prob': 0.0,
        'embedding_dim': 128,
        'hidden_dim': 128,
        'num_gnn_layers': 3,
        'num_layers': 1},
 'output_subdir': None,
 'p_net_setting': {'link_attrs_setting': [{'distribution': 'uniform',
                                           'dtype': 'int',
                                           'generative': True,
                                           'high': 100,
                                           'low': 50,
                                           'name': 'bw',
                                           'owner': 'link',
                                           'type': 'resource'},
                                          {'name': 'max_bw',
                                           'originator': 'bw',
                                           'owner': 'link',
                                           'type': 'extrema'}],
                   'node_attrs_setting': [{'distribution': 'uniform',
                                           'dtype': 'int',
                                           'generative': True,
                                           'high': 100,
                                           'low': 50,
                                           'name': 'cpu',
                                           'owner': 'node',
                                           'type': 'resource'},
                                          {'name': 'max_cpu',
                                           'originator': 'cpu',
                                           'owner': 'node',
                                           'type': 'extrema'}],
                   'output': {'file_name': 'p_net.gml',
                              'save_dir': 'dataset/p_net'},
                   'topology': {'num_nodes': 100,
                                'type': 'waxman',
                                'wm_alpha': 0.5,
                                'wm_beta': 0.2}},
 'recorder': {'if_save_records': True,
              'if_temp_save_records': True,
              'record_dir_name': 'records',
              'summary_file_name': 'summary.csv'},
 'rl': {'clip_grad': True,
        'coef_critic_loss': 0.5,
        'coef_entropy_loss': 0.01,
        'coef_mask_loss': 0.01,
        'eps_clip': 0.2,
        'explore_rate': 0.9,
        'feature_constructor': {'extracted_attr_types': ['resource'],
                                'if_use_aggregated_link_attrs': True,
                                'if_use_degree_metric': True,
                                'if_use_more_topological_metrics': True,
                                'if_use_node_status_flags': True,
                                'name': 'p_net_v_node',
                                'num_extracted_p_link_attrs': 1,
                                'num_extracted_p_node_attrs': 1,
                                'num_extracted_v_link_attrs': 1,
                                'num_extracted_v_node_attrs': 1,
                                'p_num_nodes': 100},
        'gae_lambda': 0.98,
        'gamma': 0.99,
        'if_allow_baseline_unsafe_solve': False,
        'if_use_baseline_solver': False,
        'if_use_negative_sample': True,
        'l2reg_rate': 0.00025,
        'learning_rate': {'actor': 0.001,
                          'cost_critic': 0.001,
                          'critic': 0.001,
                          'encoder': 0.001,
                          'lambda_net': 0.001,
                          'penalty_params': 0.0001},
        'mask_actions': True,
        'maskable_policy': True,
        'max_grad_norm': 0.5,
        'norm_advantage': True,
        'norm_critic_loss': False,
        'norm_reward': False,
        'repeat_times': 10,
        'reward_calculator': {'intermediate_reward': 0.1,
                              'name': 'fixed_intermediate'},
        'safe_rl': {'srl_alpha': 1.0, 'srl_beta': 0.1, 'srl_cost_budget': 0.2},
        'target_kl': None,
        'target_steps': 256,
        'weight_decay': 1e-05},
 'simulation': {'p_net_dataset_dir': 'dataset/p_net/100-waxman_[0.5-0.2]-cpu_[50-100]-max_cpu_None-bw_[50-100]-max_bw_None',
                'p_net_num_nodes': 100,
                'p_net_setting_num_link_attrs': 2,
                'p_net_setting_num_link_extrema_attrs': 1,
                'p_net_setting_num_link_resource_attrs': 1,
                'p_net_setting_num_node_attrs': 2,
                'p_net_setting_num_node_extrema_attrs': 1,
                'p_net_setting_num_node_resource_attrs': 1,
                'p_net_setting_num_nodes': 100,
                'v_nets_dataset_dir': 'dataset/v_nets/50-[2-10]-random-500-0.04-cpu_[0-20]-bw_[0-50]',
                'v_sim_setting_num_link_attrs': 1,
                'v_sim_setting_num_link_non_status_attrs': 1,
                'v_sim_setting_num_link_resource_attrs': 1,
                'v_sim_setting_num_node_attrs': 1,
                'v_sim_setting_num_node_non_status_attrs': 1,
                'v_sim_setting_num_node_resource_attrs': 1},
 'solver': {'allow_rejection': False,
            'allow_revocable': False,
            'k_shortest': 10,
            'link_ranking_method': 'order',
            'matching_mathod': 'greedy',
            'node_ranking_method': 'order',
            'pretrained_model_path': '',
            'pretrained_subsolver_model_path': '',
            'reusable': False,
            'shortest_method': 'k_shortest',
            'solver_name': 'ffd_rank',
            'sub_solver_name': None},
 'system': {'if_changeable_v_nets': False,
            'if_offline_system': False,
            'if_time_window': False,
            'renew_v_net_simulator': False,
            'time_window_size': 100},
 'training': {'batch_size': 128,
              'distributed_training': False,
              'eval_interval': 10,
              'gpu_id': 0,
              'if_use_random_training_seed': True,
              'learning_rate': 0.001,
              'log_interval': 1,
              'model_dir_name': 'models',
              'num_train_epochs': 50,
              'num_workers': 10,
              'save_interval': 10,
              'seed': None,
              'use_cuda': True,
              'weight_decay': 1e-05},
 'v_sim_setting': {'arrival_rate': {'distribution': 'poisson',
                                    'dtype': 'float',
                                    'lam': 0.04,
                                    'reciprocal': True},
                   'graph_attrs_setting': None,
                   'lifetime': {'distribution': 'exponential',
                                'dtype': 'float',
                                'scale': 500},
                   'link_attrs_setting': [{'distribution': 'uniform',
                                           'dtype': 'int',
                                           'generative': True,
                                           'high': 50,
                                           'low': 0,
                                           'name': 'bw',
                                           'owner': 'link',
                                           'type': 'resource'}],
                   'node_attrs_setting': [{'distribution': 'uniform',
                                           'dtype': 'int',
                                           'generative': True,
                                           'high': 20,
                                           'low': 0,
                                           'name': 'cpu',
                                           'owner': 'node',
                                           'type': 'resource'}],
                   'num_v_nets': 50,
                   'output': {'events_file_name': 'events.yaml',
                              'save_dir': 'dataset/v_nets',
                              'setting_file_name': 'v_sim_setting.yaml',
                              'v_nets_file_name': 'v_net.gml',
                              'v_nets_save_dir': 'v_nets'},
                   'topology': {'random_prob': 0.5, 'type': 'random'},
                   'v_net_size': {'distribution': 'uniform',
                                  'dtype': 'int',
                                  'high': 10,
                                  'low': 2}}}[0m
[32mINFO    [0m Config saved to virne/ffd_rank/Stephens-MacBook-Pro-2.local-20250515T043743/config.yaml[0m
[32mINFO    [0m 
Epoch 0[0m
[32mINFO    [0m Temp save record in virne/ffd_rank/Stephens-MacBook-Pro-2.local-20250515T043743/records/temp-0.csv
[0m
